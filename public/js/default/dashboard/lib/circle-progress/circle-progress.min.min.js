!function(b){if("function"==typeof define&&define.amd){define(["jquery"],b)}else{if("object"==typeof module&&module.exports){var a=require("jquery");b(a),module.exports=a}else{b(jQuery)}}}(function(b){function a(c){this.init(c)}a.prototype={value:0,size:100,startAngle:-Math.PI,thickness:"auto",fill:{gradient:["#3aeabb","#fdd250"]},emptyFill:"rgba(0, 0, 0, .1)",animation:{duration:1200,easing:"circleProgressEasing"},animationStartValue:0,reverse:!1,lineCap:"butt",insertMode:"prepend",constructor:a,el:null,canvas:null,ctx:null,radius:0,arcFill:null,lastFrameValue:0,init:function(c){b.extend(this,c),this.radius=this.size/2,this.initWidget(),this.initFill(),this.draw(),this.el.trigger("circle-inited")},initWidget:function(){this.canvas||(this.canvas=b("<canvas>")["prepend"==this.insertMode?"prependTo":"appendTo"](this.el)[0]);var c=this.canvas;if(c.width=this.size,c.height=this.size,this.ctx=c.getContext("2d"),window.devicePixelRatio>1){var d=window.devicePixelRatio;c.style.width=c.style.height=this.size+"px",c.width=c.height=this.size*d,this.ctx.scale(d,d)}},initFill:function(){function z(){var c=b("<canvas>")[0];c.width=q.size,c.height=q.size,c.getContext("2d").drawImage(p,0,0,f,f),q.arcFill=q.ctx.createPattern(c,"no-repeat"),q.drawFrame(q.lastFrameValue)}var q=this,x=this.fill,j=this.ctx,f=this.size;if(!x){throw Error("The fill is not specified!")}if("string"==typeof x&&(x={color:x}),x.color&&(this.arcFill=x.color),x.gradient){var A=x.gradient;if(1==A.length){this.arcFill=A[0]}else{if(A.length>1){for(var k=x.gradientAngle||0,i=x.gradientDirection||[f/2*(1-Math.cos(k)),f/2*(1+Math.sin(k)),f/2*(1+Math.cos(k)),f/2*(1-Math.sin(k))],m=j.createLinearGradient.apply(j,i),w=0;w<A.length;w++){var v=A[w],y=w/(A.length-1);b.isArray(v)&&(y=v[1],v=v[0]),m.addColorStop(y,v)}this.arcFill=m}}}if(x.image){var p;x.image instanceof Image?p=x.image:(p=new Image,p.src=x.image),p.complete?z():p.onload=z}},draw:function(){this.animation?this.drawAnimated(this.value):this.drawFrame(this.value)},drawFrame:function(c){this.lastFrameValue=c,this.ctx.clearRect(0,0,this.size,this.size),this.drawEmptyArc(c),this.drawArc(c)},drawArc:function(f){if(0!==f){var d=this.ctx,g=this.radius,c=this.getThickness(),h=this.startAngle;d.save(),d.beginPath(),this.reverse?d.arc(g,g,g-c/2,h-2*Math.PI*f,h):d.arc(g,g,g-c/2,h,h+2*Math.PI*f),d.lineWidth=c,d.lineCap=this.lineCap,d.strokeStyle=this.arcFill,d.stroke(),d.restore()}},drawEmptyArc:function(f){var d=this.ctx,g=this.radius,c=this.getThickness(),h=this.startAngle;f<1&&(d.save(),d.beginPath(),f<=0?d.arc(g,g,g-c/2,0,2*Math.PI):this.reverse?d.arc(g,g,g-c/2,h,h-2*Math.PI*f):d.arc(g,g,g-c/2,h+2*Math.PI*f,h),d.lineWidth=c,d.strokeStyle=this.emptyFill,d.stroke(),d.restore())},drawAnimated:function(d){var f=this,c=this.el,g=b(this.canvas);g.stop(!0,!1),c.trigger("circle-animation-start"),g.css({animationProgress:0}).animate({animationProgress:1},b.extend({},this.animation,{step:function(e){var h=f.animationStartValue*(1-e)+d*e;f.drawFrame(h),c.trigger("circle-animation-progress",[e,h])}})).promise().always(function(){c.trigger("circle-animation-end")})},getThickness:function(){return b.isNumeric(this.thickness)?this.thickness:this.size/14},getValue:function(){return this.value},setValue:function(c){this.animation&&(this.animationStartValue=this.lastFrameValue),this.value=c,this.draw()}},b.circleProgress={defaults:a.prototype},b.easing.circleProgressEasing=function(f,d,g,c,h){return(d/=h/2)<1?c/2*d*d*d+g:c/2*((d-=2)*d*d+2)+g},b.fn.circleProgress=function(g,c){var h="circle-progress",f=this.data(h);if("widget"==g){if(!f){throw Error('Calling "widget" method on not initialized instance is forbidden')}return f.canvas}if("value"==g){if(!f){throw Error('Calling "value" method on not initialized instance is forbidden')}if("undefined"==typeof c){return f.getValue()}var d=arguments[1];return this.each(function(){b(this).data(h).setValue(d)})}return this.each(function(){var i=b(this),k=i.data(h),j=b.isPlainObject(g)?g:{};if(k){k.init(j)}else{var e=b.extend({},i.data());"string"==typeof e.fill&&(e.fill=JSON.parse(e.fill)),"string"==typeof e.animation&&(e.animation=JSON.parse(e.animation)),j=b.extend(e,j),j.el=i,k=new a(j),i.data(h,k)}})}});