function ElasticSlider(c,d){this.el=typeof c==="string"?document.querySelector(c):c;this.init(d)}ElasticSlider.prototype={init:function(b){this.items=this.el.children;this.len=this.items.length;if(this.len<3){throw new Error("ElasticSlider must have at least 3 items.")}this.mouseDown=false;this.animating=false;this.width=0;this.maxStretch=b&&b.hasOwnProperty("maxStretch")?parseFloat(b.maxStretch):100;this.bezierLen=b&&b.hasOwnProperty("bezierLen")?parseFloat(b.bezierLen):80;this.rect=this.el.getBoundingClientRect();this.sliderWidth=this.rect.width;this.sliderHeight=this.rect.height;this.initOrder();this.initSVG();this.initPaths();this.initEvents()},initOrder:function(){this.currentIndex=0;this.updateElements();this.addClasses()},initSVG:function(){this._svgNS="http://www.w3.org/2000/svg";this.clippedLeft=document.createElementNS(this._svgNS,"clipPath");this.clippedRight=document.createElementNS(this._svgNS,"clipPath");this.clippedLeft.id="clipped-left";this.clippedRight.id="clipped-right";this.s=new Snap(this.sliderWidth,this.sliderHeight);this.s.select("defs").node.appendChild(this.clippedLeft);this.s.select("defs").node.appendChild(this.clippedRight);this.el.appendChild(this.s.node)},initPaths:function(){this.optionsLeft={x1:0,y1:0,y2:this.sliderHeight,width:0,bezierLen:this.bezierLen,offset:this.sliderWidth,leftSide:true};this.optionsLeftAux={x1:0,y1:0,y2:this.sliderHeight,width:0,bezierLen:this.bezierLen,offset:this.sliderWidth,leftSide:true};this.curveLeft=this.createPath(this.optionsLeft);this.pLeft=this.s.path(this.curveLeft).attr({transform:"t-"+this.sliderWidth+", 0"});this.optionsRight={x1:this.sliderWidth,y1:0,y2:this.sliderHeight,width:0,bezierLen:this.bezierLen,offset:this.sliderWidth};this.optionsRightAux={x1:this.sliderWidth,y1:0,y2:this.sliderHeight,width:0,bezierLen:this.bezierLen,offset:this.sliderWidth};this.curveRight=this.createPath(this.optionsRight);this.pRight=this.s.path(this.curveRight).attr({transform:"t-"+this.sliderWidth+", 0"});this.clippedLeft.appendChild(this.pLeft.node);this.clippedRight.appendChild(this.pRight.node)},createPath:function(q){var r=q.x1,k=q.y1,s=r,l=q.y2,t=(r+q.width),m=(l-k)/2,n=q.bezierLen,o=q.offset;var p=["M",r+o,k,"C",r+o,(k+n),t+o,(m-n),t+o,m,"S",s+o,(l-n),s+o,l,"L"];q.leftSide?p.push(r,l,"L",r,k):p.push(r+o*2,l,"L",r+o*2,k);return p.join(" ")},initEvents:function(){this.initDown();this.initUp();this.initMove()},initDown:function(){var b=this;b.el.onmousedown=function(a){if(!b.animating){b.mouseDown=true;b.initialX=a.pageX}}},initUp:function(){var b=this;document.onmouseup=function(){if(b.mouseDown&&!b.animating){b.mouseDown=false;b.pLeft.stop().animate({path:b.curveLeft},200,mina.easeout);b.pRight.stop().animate({path:b.curveRight},200,mina.easeout)}}},initMove:function(){var b=this;b.el.onmousemove=function(a){if(b.mouseDown&&!b.animating){b.width=a.pageX-b.initialX;if(a.pageX>b.initialX){b.prevAnimation()}else{b.nextAnimation()}}}},prevAnimation:function(){var f=this;f.pRight.stop().attr({path:f.curveRight});if(f.width<f.maxStretch){f.optionsLeftAux.width=f.width;f.pLeft.stop().attr({d:f.createPath(f.optionsLeftAux)})}else{f.mouseDown=false;f.animating=true;f.optionsLeft.x1=f.maxStretch*2;f.optionsLeft.width=-f.maxStretch*3/4;var e=f.createPath(f.optionsLeft);f.optionsLeft.x1=f.maxStretch*2;f.optionsLeft.width=f.maxStretch/4;var g=f.createPath(f.optionsLeft);f.optionsLeft.x1=f.maxStretch*3;f.optionsLeft.width=0;var h=f.createPath(f.optionsLeft);f.pLeft.stop().animate({transform:"t-"+(f.maxStretch*3-50)+",0"},300,mina.easein,function(){f.pLeft.animate({transform:"t-"+(f.maxStretch*3)+",0"},200,mina.easein)});f.pLeft.animate({path:e},200,mina.easein,function(){f.pLeft.animate({path:g},100,mina.easein,function(){f.pLeft.animate({path:h},200,mina.easein,function(){f.prev();f.updateStates();f.pLeft.stop().attr({d:f.curveLeft,transform:"t-"+f.sliderWidth+", 0"});f.animating=false})})})}},nextAnimation:function(){var e=this;e.pLeft.stop().attr({path:e.curveLeft});if(e.width>-e.maxStretch){e.optionsRightAux.width=e.width;e.pRight.stop().attr({d:e.createPath(e.optionsRightAux)})}else{e.mouseDown=false;e.animating=true;e.pRight.stop().animate({path:e.curveRight},2000,mina.elastic);e.optionsRight.x1=e.sliderWidth-e.maxStretch*2;e.optionsRight.width=e.maxStretch*3/4;var g=e.createPath(e.optionsRight);e.optionsRight.x1=e.sliderWidth-e.maxStretch*2;e.optionsRight.width=-e.maxStretch/4;var h=e.createPath(e.optionsRight);e.optionsRight.x1=e.sliderWidth-e.maxStretch*3;e.optionsRight.width=0;var f=e.createPath(e.optionsRight);e.pRight.stop().animate({transform:"t-"+(e.sliderWidth*2-(e.maxStretch*3-50))+",0"},300,mina.easein,function(){e.pRight.animate({transform:"t-"+(e.sliderWidth*2-e.maxStretch*3)+",0"},200,mina.easein)});e.pRight.animate({path:g},200,mina.easein,function(){e.pRight.animate({path:h},100,mina.easein,function(){e.pRight.animate({path:f},200,mina.easein,function(){e.next();e.updateStates();e.pRight.stop().attr({d:e.curveRight,transform:"t-"+(e.sliderWidth)+", 0"});e.animating=false})})})}},prev:function(){this.currentIndex=this.getPrevIndex()},next:function(){this.currentIndex=this.getNextIndex()},getPrevIndex:function(){return this.currentIndex>0?this.currentIndex-1:this.len-1},getNextIndex:function(){return this.currentIndex+1<this.len?this.currentIndex+1:0},updateStates:function(){this.removeClasses();this.updateElements();this.addClasses()},removeClasses:function(){this.currentItem.classList.remove("current");this.prevItem.classList.remove("clipped-left");this.nextItem.classList.remove("clipped-right")},updateElements:function(){this.currentItem=this.items[this.currentIndex];this.prevItem=this.items[this.getPrevIndex()];this.nextItem=this.items[this.getNextIndex()]},addClasses:function(){this.currentItem.classList.add("current");this.prevItem.classList.add("clipped-left");this.nextItem.classList.add("clipped-right")}};module.exports=ElasticSlider;