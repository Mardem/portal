function ElasticSlider(b,a){this.el=typeof b==="string"?document.querySelector(b):b;this.init(a)}ElasticSlider.prototype={init:function(a){this.items=this.el.children;this.len=this.items.length;if(this.len<3){throw new Error("ElasticSlider must have at least 3 items.")}this.mouseDown=false;this.animating=false;this.width=0;this.maxStretch=a&&a.hasOwnProperty("maxStretch")?parseFloat(a.maxStretch):100;this.bezierLen=a&&a.hasOwnProperty("bezierLen")?parseFloat(a.bezierLen):80;this.rect=this.el.getBoundingClientRect();this.sliderWidth=this.rect.width;this.sliderHeight=this.rect.height;this.initOrder();this.initSVG();this.initPaths();this.initEvents()},initOrder:function(){this.currentIndex=0;this.updateElements();this.addClasses()},initSVG:function(){this._svgNS="http://www.w3.org/2000/svg";this.clippedLeft=document.createElementNS(this._svgNS,"clipPath");this.clippedRight=document.createElementNS(this._svgNS,"clipPath");this.clippedLeft.id="clipped-left";this.clippedRight.id="clipped-right";this.s=new Snap(this.sliderWidth,this.sliderHeight);this.s.select("defs").node.appendChild(this.clippedLeft);this.s.select("defs").node.appendChild(this.clippedRight);this.el.appendChild(this.s.node)},initPaths:function(){this.optionsLeft={x1:0,y1:0,y2:this.sliderHeight,width:0,bezierLen:this.bezierLen,offset:this.sliderWidth,leftSide:true};this.optionsLeftAux={x1:0,y1:0,y2:this.sliderHeight,width:0,bezierLen:this.bezierLen,offset:this.sliderWidth,leftSide:true};this.curveLeft=this.createPath(this.optionsLeft);this.pLeft=this.s.path(this.curveLeft).attr({transform:"t-"+this.sliderWidth+", 0"});this.optionsRight={x1:this.sliderWidth,y1:0,y2:this.sliderHeight,width:0,bezierLen:this.bezierLen,offset:this.sliderWidth};this.optionsRightAux={x1:this.sliderWidth,y1:0,y2:this.sliderHeight,width:0,bezierLen:this.bezierLen,offset:this.sliderWidth};this.curveRight=this.createPath(this.optionsRight);this.pRight=this.s.path(this.curveRight).attr({transform:"t-"+this.sliderWidth+", 0"});this.clippedLeft.appendChild(this.pLeft.node);this.clippedRight.appendChild(this.pRight.node)},createPath:function(d){var c=d.x1,j=d.y1,b=c,i=d.y2,a=(c+d.width),h=(i-j)/2,g=d.bezierLen,f=d.offset;var e=["M",c+f,j,"C",c+f,(j+g),a+f,(h-g),a+f,h,"S",b+f,(i-g),b+f,i,"L"];d.leftSide?e.push(c,i,"L",c,j):e.push(c+f*2,i,"L",c+f*2,j);return e.join(" ")},initEvents:function(){this.initDown();this.initUp();this.initMove()},initDown:function(){var a=this;a.el.onmousedown=function(b){if(!a.animating){a.mouseDown=true;a.initialX=b.pageX}}},initUp:function(){var a=this;document.onmouseup=function(){if(a.mouseDown&&!a.animating){a.mouseDown=false;a.pLeft.stop().animate({path:a.curveLeft},200,mina.easeout);a.pRight.stop().animate({path:a.curveRight},200,mina.easeout)}}},initMove:function(){var a=this;a.el.onmousemove=function(b){if(a.mouseDown&&!a.animating){a.width=b.pageX-a.initialX;if(b.pageX>a.initialX){a.prevAnimation()}else{a.nextAnimation()}}}},prevAnimation:function(){var a=this;a.pRight.stop().attr({path:a.curveRight});if(a.width<a.maxStretch){a.optionsLeftAux.width=a.width;a.pLeft.stop().attr({d:a.createPath(a.optionsLeftAux)})}else{a.mouseDown=false;a.animating=true;a.optionsLeft.x1=a.maxStretch*2;a.optionsLeft.width=-a.maxStretch*3/4;var b=a.createPath(a.optionsLeft);a.optionsLeft.x1=a.maxStretch*2;a.optionsLeft.width=a.maxStretch/4;var d=a.createPath(a.optionsLeft);a.optionsLeft.x1=a.maxStretch*3;a.optionsLeft.width=0;var c=a.createPath(a.optionsLeft);a.pLeft.stop().animate({transform:"t-"+(a.maxStretch*3-50)+",0"},300,mina.easein,function(){a.pLeft.animate({transform:"t-"+(a.maxStretch*3)+",0"},200,mina.easein)});a.pLeft.animate({path:b},200,mina.easein,function(){a.pLeft.animate({path:d},100,mina.easein,function(){a.pLeft.animate({path:c},200,mina.easein,function(){a.prev();a.updateStates();a.pLeft.stop().attr({d:a.curveLeft,transform:"t-"+a.sliderWidth+", 0"});a.animating=false})})})}},nextAnimation:function(){var b=this;b.pLeft.stop().attr({path:b.curveLeft});if(b.width>-b.maxStretch){b.optionsRightAux.width=b.width;b.pRight.stop().attr({d:b.createPath(b.optionsRightAux)})}else{b.mouseDown=false;b.animating=true;b.pRight.stop().animate({path:b.curveRight},2000,mina.elastic);b.optionsRight.x1=b.sliderWidth-b.maxStretch*2;b.optionsRight.width=b.maxStretch*3/4;var d=b.createPath(b.optionsRight);b.optionsRight.x1=b.sliderWidth-b.maxStretch*2;b.optionsRight.width=-b.maxStretch/4;var c=b.createPath(b.optionsRight);b.optionsRight.x1=b.sliderWidth-b.maxStretch*3;b.optionsRight.width=0;var a=b.createPath(b.optionsRight);b.pRight.stop().animate({transform:"t-"+(b.sliderWidth*2-(b.maxStretch*3-50))+",0"},300,mina.easein,function(){b.pRight.animate({transform:"t-"+(b.sliderWidth*2-b.maxStretch*3)+",0"},200,mina.easein)});b.pRight.animate({path:d},200,mina.easein,function(){b.pRight.animate({path:c},100,mina.easein,function(){b.pRight.animate({path:a},200,mina.easein,function(){b.next();b.updateStates();b.pRight.stop().attr({d:b.curveRight,transform:"t-"+(b.sliderWidth)+", 0"});b.animating=false})})})}},prev:function(){this.currentIndex=this.getPrevIndex()},next:function(){this.currentIndex=this.getNextIndex()},getPrevIndex:function(){return this.currentIndex>0?this.currentIndex-1:this.len-1},getNextIndex:function(){return this.currentIndex+1<this.len?this.currentIndex+1:0},updateStates:function(){this.removeClasses();this.updateElements();this.addClasses()},removeClasses:function(){this.currentItem.classList.remove("current");this.prevItem.classList.remove("clipped-left");this.nextItem.classList.remove("clipped-right")},updateElements:function(){this.currentItem=this.items[this.currentIndex];this.prevItem=this.items[this.getPrevIndex()];this.nextItem=this.items[this.getNextIndex()]},addClasses:function(){this.currentItem.classList.add("current");this.prevItem.classList.add("clipped-left");this.nextItem.classList.add("clipped-right")}};module.exports=ElasticSlider;