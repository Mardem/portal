function ElasticSlider(b,a){this.el=typeof b==="string"?document.querySelector(b):b;this.init(a)}ElasticSlider.prototype={init:function(a){this.items=this.el.children;this.len=this.items.length;if(this.len<3){throw new Error("ElasticSlider must have at least 3 items.")}this.mouseDown=false;this.animating=false;this.width=0;this.maxStretch=a&&a.hasOwnProperty("maxStretch")?parseFloat(a.maxStretch):100;this.bezierLen=a&&a.hasOwnProperty("bezierLen")?parseFloat(a.bezierLen):80;this.rect=this.el.getBoundingClientRect();this.sliderWidth=this.rect.width;this.sliderHeight=this.rect.height;this.initOrder();this.initSVG();this.initPaths();this.initEvents()},initOrder:function(){this.currentIndex=0;this.updateElements();this.addClasses()},initSVG:function(){this._svgNS="http://www.w3.org/2000/svg";this.clippedLeft=document.createElementNS(this._svgNS,"clipPath");this.clippedRight=document.createElementNS(this._svgNS,"clipPath");this.clippedLeft.id="clipped-left";this.clippedRight.id="clipped-right";this.s=new Snap(this.sliderWidth,this.sliderHeight);this.s.select("defs").node.appendChild(this.clippedLeft);this.s.select("defs").node.appendChild(this.clippedRight);this.el.appendChild(this.s.node)},initPaths:function(){this.optionsLeft={x1:0,y1:0,y2:this.sliderHeight,width:0,bezierLen:this.bezierLen,offset:this.sliderWidth,leftSide:true};this.optionsLeftAux={x1:0,y1:0,y2:this.sliderHeight,width:0,bezierLen:this.bezierLen,offset:this.sliderWidth,leftSide:true};this.curveLeft=this.createPath(this.optionsLeft);this.pLeft=this.s.path(this.curveLeft).attr({transform:"t-"+this.sliderWidth+", 0"});this.optionsRight={x1:this.sliderWidth,y1:0,y2:this.sliderHeight,width:0,bezierLen:this.bezierLen,offset:this.sliderWidth};this.optionsRightAux={x1:this.sliderWidth,y1:0,y2:this.sliderHeight,width:0,bezierLen:this.bezierLen,offset:this.sliderWidth};this.curveRight=this.createPath(this.optionsRight);this.pRight=this.s.path(this.curveRight).attr({transform:"t-"+this.sliderWidth+", 0"});this.clippedLeft.appendChild(this.pLeft.node);this.clippedRight.appendChild(this.pRight.node)},createPath:function(b){var a=b.x1,h=b.y1,j=a,g=b.y2,i=(a+b.width),f=(g-h)/2,e=b.bezierLen,d=b.offset;var c=["M",a+d,h,"C",a+d,(h+e),i+d,(f-e),i+d,f,"S",j+d,(g-e),j+d,g,"L"];b.leftSide?c.push(a,g,"L",a,h):c.push(a+d*2,g,"L",a+d*2,h);return c.join(" ")},initEvents:function(){this.initDown();this.initUp();this.initMove()},initDown:function(){var a=this;a.el.onmousedown=function(b){if(!a.animating){a.mouseDown=true;a.initialX=b.pageX}}},initUp:function(){var a=this;document.onmouseup=function(){if(a.mouseDown&&!a.animating){a.mouseDown=false;a.pLeft.stop().animate({path:a.curveLeft},200,mina.easeout);a.pRight.stop().animate({path:a.curveRight},200,mina.easeout)}}},initMove:function(){var a=this;a.el.onmousemove=function(b){if(a.mouseDown&&!a.animating){a.width=b.pageX-a.initialX;if(b.pageX>a.initialX){a.prevAnimation()}else{a.nextAnimation()}}}},prevAnimation:function(){var c=this;c.pRight.stop().attr({path:c.curveRight});if(c.width<c.maxStretch){c.optionsLeftAux.width=c.width;c.pLeft.stop().attr({d:c.createPath(c.optionsLeftAux)})}else{c.mouseDown=false;c.animating=true;c.optionsLeft.x1=c.maxStretch*2;c.optionsLeft.width=-c.maxStretch*3/4;var d=c.createPath(c.optionsLeft);c.optionsLeft.x1=c.maxStretch*2;c.optionsLeft.width=c.maxStretch/4;var b=c.createPath(c.optionsLeft);c.optionsLeft.x1=c.maxStretch*3;c.optionsLeft.width=0;var a=c.createPath(c.optionsLeft);c.pLeft.stop().animate({transform:"t-"+(c.maxStretch*3-50)+",0"},300,mina.easein,function(){c.pLeft.animate({transform:"t-"+(c.maxStretch*3)+",0"},200,mina.easein)});c.pLeft.animate({path:d},200,mina.easein,function(){c.pLeft.animate({path:b},100,mina.easein,function(){c.pLeft.animate({path:a},200,mina.easein,function(){c.prev();c.updateStates();c.pLeft.stop().attr({d:c.curveLeft,transform:"t-"+c.sliderWidth+", 0"});c.animating=false})})})}},nextAnimation:function(){var d=this;d.pLeft.stop().attr({path:d.curveLeft});if(d.width>-d.maxStretch){d.optionsRightAux.width=d.width;d.pRight.stop().attr({d:d.createPath(d.optionsRightAux)})}else{d.mouseDown=false;d.animating=true;d.pRight.stop().animate({path:d.curveRight},2000,mina.elastic);d.optionsRight.x1=d.sliderWidth-d.maxStretch*2;d.optionsRight.width=d.maxStretch*3/4;var b=d.createPath(d.optionsRight);d.optionsRight.x1=d.sliderWidth-d.maxStretch*2;d.optionsRight.width=-d.maxStretch/4;var a=d.createPath(d.optionsRight);d.optionsRight.x1=d.sliderWidth-d.maxStretch*3;d.optionsRight.width=0;var c=d.createPath(d.optionsRight);d.pRight.stop().animate({transform:"t-"+(d.sliderWidth*2-(d.maxStretch*3-50))+",0"},300,mina.easein,function(){d.pRight.animate({transform:"t-"+(d.sliderWidth*2-d.maxStretch*3)+",0"},200,mina.easein)});d.pRight.animate({path:b},200,mina.easein,function(){d.pRight.animate({path:a},100,mina.easein,function(){d.pRight.animate({path:c},200,mina.easein,function(){d.next();d.updateStates();d.pRight.stop().attr({d:d.curveRight,transform:"t-"+(d.sliderWidth)+", 0"});d.animating=false})})})}},prev:function(){this.currentIndex=this.getPrevIndex()},next:function(){this.currentIndex=this.getNextIndex()},getPrevIndex:function(){return this.currentIndex>0?this.currentIndex-1:this.len-1},getNextIndex:function(){return this.currentIndex+1<this.len?this.currentIndex+1:0},updateStates:function(){this.removeClasses();this.updateElements();this.addClasses()},removeClasses:function(){this.currentItem.classList.remove("current");this.prevItem.classList.remove("clipped-left");this.nextItem.classList.remove("clipped-right")},updateElements:function(){this.currentItem=this.items[this.currentIndex];this.prevItem=this.items[this.getPrevIndex()];this.nextItem=this.items[this.getNextIndex()]},addClasses:function(){this.currentItem.classList.add("current");this.prevItem.classList.add("clipped-left");this.nextItem.classList.add("clipped-right")}};